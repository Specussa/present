import{d as N,e as h,m as U,U as X,f as j,o as J,c as K}from"./vendor-@vue-Bz_wJ882.js";import{_ as Q}from"./index-CXQX6UJ3.js";const c=.4,w=-.105,V=N({__name:"Cubes",props:{cubeCount:{default:40},minSize:{default:20},maxSize:{default:40},minDuration:{default:20},maxDuration:{default:50},text:{default:"EM"},textColor:{default:"#FFFFFF"},fontSizeScale:{default:.5}},setup(M){const n=M,P=[{base:"#1e90ff",light:"#63b4ff"},{base:"#4169e1",light:"#7a93ee"},{base:"#2b86c5",light:"#5ca5e3"},{base:"#1c3f8f",light:"#3a5bb8"},{base:"#00bfff",light:"#4ad1ff"},{base:"#4682b4",light:"#75a5d1"},{base:"#6495ed",light:"#8fb0f2"}],f=h(null),t=h(null),m=h(null),E=h([]),o=h({width:0,height:0}),T=h(0),_=h(!1),u=(e,a)=>Math.random()*(a-e)+e,F=()=>{if(!f.value)return!1;const e=f.value;try{const a=e.parentElement;if(!a)return!1;const i=a.getBoundingClientRect();if(i.width<=0||i.height<=0){const d=window.getComputedStyle(a),S=parseInt(d.width)||a.offsetWidth||a.clientWidth,g=parseInt(d.height)||a.offsetHeight||a.clientHeight;if(S<=0||g<=0)return!1;o.value={width:S,height:g}}else o.value={width:i.width,height:i.height};const l=window.devicePixelRatio||1;e.width=o.value.width*l,e.height=o.value.height*l,e.style.width=`${o.value.width}px`,e.style.height=`${o.value.height}px`;const v=e.getContext("2d",{alpha:!0});return v?(t.value=v,l!==1&&t.value.scale(l,l),!0):!1}catch{return!1}},B=()=>{const e=u(n.minSize,n.maxSize),a=u(n.minDuration,n.maxDuration);return{id:Date.now()+Math.random(),x:u(2,98),size:e,animationDelay:0,animationDuration:a,colorIndex:Math.floor(u(0,P.length-1)),initialRadius:u(1,3),progress:w,startTime:0,active:!0}},k=(e,a)=>{e.startTime=a+w*e.animationDuration*1e3,e.progress=w,e.active=!0},L=(e,a)=>{e.x=u(2,98),e.colorIndex=Math.floor(u(0,P.length-1)),e.initialRadius=u(1,3),e.animationDuration=u(n.minDuration,n.maxDuration),e.startTime=a+w*e.animationDuration*1e3,e.progress=w,e.active=!0},D=()=>{const e=[];for(let a=0;a<n.cubeCount;a++){const i=B();e.push(i)}E.value=e},O=(e,a,i,l)=>{if(!t.value)throw new Error("Canvas context not available");const v=P[l],d=t.value.createLinearGradient(e,a,e+i,a+i);return d.addColorStop(0,v.base),d.addColorStop(1,v.light),d},W=(e,a)=>{if(!e.active)return;const i=(a-e.startTime)/1e3;e.progress=Math.min(1,i/e.animationDuration),e.progress>=c&&L(e,a)},Y=(e,a,i,l)=>{if(!t.value||!n.text)return;const v=e.size*n.fontSizeScale;t.value.font=`bold ${v}px Arial, sans-serif`,t.value.textAlign="center",t.value.textBaseline="middle",t.value.fillStyle=n.textColor,t.value.globalAlpha=l*.8,t.value.fillText(n.text,a+e.size/2,i+e.size/2),t.value.shadowColor="rgba(0, 0, 0, 0.3)",t.value.shadowBlur=2,t.value.shadowOffsetX=.5,t.value.shadowOffsetY=.5,t.value.fillText(n.text,a+e.size/2,i+e.size/2),t.value.shadowColor="transparent",t.value.shadowBlur=0,t.value.shadowOffsetX=0,t.value.shadowOffsetY=0},H=e=>{if(!t.value||!e.active||o.value.height===0||e.progress<0)return;const a=e.x/100*o.value.width-e.size/2,i=window.innerHeight+100,l=o.value.height*(1-c),v=i-(i-l)*(e.progress/c),d=f.value;if(!d)return;const S=d.getBoundingClientRect(),g=v-S.top;let C=0;const R=c*.7;e.progress<R?C=.15+.25*(e.progress/R):C=.4-.4*((e.progress-R)/(c-R));let s=e.initialRadius;const I=c*.8;e.progress<I?s=e.initialRadius+(e.size/2-e.initialRadius)*(e.progress/I):s=e.size/2;let q=1-.3*(e.progress/c);const G=e.progress*2*Math.PI*2;if(C<.01||g<-e.size||g>o.value.height+e.size)return;t.value.save(),t.value.translate(a+e.size/2,g+e.size/2),t.value.scale(q,q),t.value.rotate(G),t.value.translate(-e.size/2,-e.size/2);const $=O(0,0,e.size,e.colorIndex);if(s<e.size/2-.5?(t.value.beginPath(),t.value.moveTo(s,0),t.value.lineTo(e.size-s,0),t.value.quadraticCurveTo(e.size,0,e.size,s),t.value.lineTo(e.size,e.size-s),t.value.quadraticCurveTo(e.size,e.size,e.size-s,e.size),t.value.lineTo(s,e.size),t.value.quadraticCurveTo(0,e.size,0,e.size-s),t.value.lineTo(0,s),t.value.quadraticCurveTo(0,0,s,0),t.value.closePath()):(t.value.beginPath(),t.value.arc(e.size/2,e.size/2,e.size/2,0,Math.PI*2),t.value.closePath()),t.value.fillStyle=$,t.value.globalAlpha=C,t.value.fill(),Y(e,0,0,C),t.value.strokeStyle="rgba(255, 255, 255, 0.12)",t.value.lineWidth=.5,t.value.stroke(),s<e.size/2){t.value.beginPath();const r=Math.max(.5,s-.5);t.value.moveTo(r,.5),t.value.lineTo(e.size-r,.5),t.value.quadraticCurveTo(e.size-.5,.5,e.size-.5,r),t.value.lineTo(e.size-.5,e.size-r),t.value.quadraticCurveTo(e.size-.5,e.size-.5,e.size-r,e.size-.5),t.value.lineTo(r,e.size-.5),t.value.quadraticCurveTo(.5,e.size-.5,.5,e.size-r),t.value.lineTo(.5,r),t.value.quadraticCurveTo(.5,.5,r,.5),t.value.closePath(),t.value.strokeStyle="rgba(255, 255, 255, 0.2)",t.value.lineWidth=.3,t.value.stroke()}t.value.restore()},A=e=>{if(!t.value||!f.value||o.value.width===0){m.value=requestAnimationFrame(A);return}if(T.value===0){T.value=e;const i=0;E.value.forEach(l=>{k(l,i)})}const a=e-T.value;t.value.clearRect(0,0,o.value.width,o.value.height),E.value.forEach(i=>{W(i,a),H(i)}),m.value=requestAnimationFrame(A)},z=()=>{_.value||setTimeout(()=>{if(!F()){setTimeout(z,100);return}D(),T.value=0,_.value=!0,m.value=requestAnimationFrame(A)},100)},x=()=>{_.value=!1,m.value&&(cancelAnimationFrame(m.value),m.value=null)};let p=null;const y=()=>{p&&clearTimeout(p),p=setTimeout(()=>{var a;if(!((a=f.value)!=null&&a.parentElement))return;const e=f.value.parentElement;e.offsetWidth<=0||e.offsetHeight<=0||(x(),z())},150)};return U(()=>{z(),window.addEventListener("resize",y),document.addEventListener("visibilitychange",()=>{document.hidden?x():setTimeout(()=>{z()},100)})}),X(()=>{x(),p&&clearTimeout(p),window.removeEventListener("resize",y),document.removeEventListener("visibilitychange",()=>{})}),j(()=>[n.cubeCount,n.text,n.textColor,n.fontSizeScale],()=>{x(),D(),z()}),(e,a)=>(J(),K("canvas",{ref_key:"canvasRef",ref:f,class:"cubes"},null,512))}}),ee=Q(V,[["__scopeId","data-v-d3aed5e8"]]);export{ee as C};

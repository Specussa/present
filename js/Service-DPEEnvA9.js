import{X as H,Y as U,Z as q,_ as j}from"./vendor-@element-plus-zuhFJ_6P.js";import{E as h}from"./vendor-element-plus-CZs5FMWl.js";import{d as N,b as l,j as L,al as V,o as d,c as T,Q as p,a as _,H as w,u as f,L as k,C as D,P as Q}from"./vendor-@vue-Cg4sS8W0.js";import{u as X}from"./vendor-vue-i18n-D0pj9gOW.js";import{_ as B}from"./index-CPta0tcF.js";import{H as Y}from"./Header-BecD31pj.js";import{F as Z}from"./Footer-D9Epa5fJ.js";import"./vendor-lodash-es-C-zDejYo.js";import"./vendor-@vueuse-D3zzmj5p.js";import"./vendor-@popperjs-D9SI2xQl.js";import"./vendor-@ctrl-r5W6hzzQ.js";import"./vendor-dayjs-D6RD0Zoz.js";import"./vendor-async-validator-DKvM95Vc.js";import"./vendor-memoize-one-BdPwpGay.js";import"./vendor-normalize-wheel-es-B6fDCfyv.js";import"./vendor-@floating-ui-DF51-gJp.js";import"./vendor-@intlify-CQT3u4ju.js";import"./vendor-geotiff-BjC_-_Sy.js";import"./vendor-xml-utils-BmThcpyG.js";import"./vendor-@petamoriken-D_Z9L4hp.js";import"./vendor-quick-lru-D3vInPgE.js";import"./vendor-pako-CPws4d4z.js";import"./vendor-lerc-B0C9zqkp.js";import"./vendor-zstddec-zw5PE4Vj.js";import"./vendor-web-worker-2oq5GE5I.js";import"./vendor-vue-router-BMJZZRG0.js";import"./vendor-axios-BimPEqV4.js";import"./vendor-vue-tel-input-BZrepA_w.js";import"./LogoSVG-C3qW82K5.js";const G={class:"voice"},J={class:"voice__controls"},K=N({__name:"VoicePlayer",setup(F){const{locale:y}=X(),u=l(""),i=l(!1),R=l(!1),n=l(!1),r=l(!1),S=l(!1),a=l(null),g=l(""),I=()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;return n.value=!!e,!!e},t=e=>{h.error(e)},v=e=>{h.info(e)},M=e=>{h.success(e)},E=async()=>{var e;if(!((e=navigator.mediaDevices)!=null&&e.getUserMedia))return t("Браузер не поддерживает доступ к медиаустройствам"),!1;S.value=!0;try{return(await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})).getTracks().forEach(c=>c.stop()),r.value=!1,x(),M("Микрофон подключен"),!0}catch(o){return r.value=!0,o instanceof Error?o.name==="NotAllowedError"?t("Доступ к микрофону запрещен"):o.name==="NotFoundError"?t("Микрофон не найден"):o.name==="NotSupportedError"?t("Браузер не поддерживает доступ к микрофону"):t("Ошибка доступа к микрофону"):t("Ошибка доступа к микрофону"),!1}finally{S.value=!1}},x=()=>{if(!I()){t("Браузер не поддерживает распознавание речи");return}const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e){t("Распознавание речи не поддерживается");return}a.value=new e,a.value.continuous=!0,a.value.interimResults=!0,a.value.lang=y.value,a.value.onstart=()=>{i.value=!0,v("Запись началась")},a.value.onresult=o=>{let c="";for(let s=o.resultIndex;s<o.results.length;s++){const m=o.results[s],P=m[0].transcript;m.isFinal?g.value+=P+" ":c+=P}u.value=g.value+c},a.value.onerror=o=>{switch(o.error){case"not-allowed":case"service-not-allowed":r.value=!0,t("Доступ к микрофону запрещен");break;case"audio-capture":t("Микрофон не найден");break;case"aborted":t("Распознавание прервано");break;case"network":t("Проблемы с сетью");break;case"no-speech":v("Речь не обнаружена");break;default:t(`Ошибка: ${o.error}`)}b()},a.value.onend=()=>{i.value&&!R.value&&a.value?setTimeout(()=>{if(i.value&&a.value)try{a.value.start()}catch{b()}},100):(i.value=!1,v("Запись остановлена"))}},C=async()=>{n.value&&(r.value&&!await E()||(i.value?b():$()))},$=()=>{if(a.value)try{a.value.start(),v("Запись началась")}catch(e){e instanceof Error&&(e.message.includes("permission")||e.name==="NotAllowedError")?(r.value=!0,t("Разрешите доступ к микрофону")):t("Ошибка при запуске записи")}},b=()=>{if(a.value)try{a.value.stop(),i.value=!1,R.value=!1}catch{t("Ошибка при остановке записи")}},z=()=>{u.value="",g.value="",v("Текст очищен")},A=async()=>{var e;try{if(!((e=navigator.mediaDevices)!=null&&e.enumerateDevices)){r.value=!0;return}const c=(await navigator.mediaDevices.enumerateDevices()).some(s=>s.kind==="audioinput"&&s.label!=="");r.value=!c}catch{r.value=!0}};return L(async()=>{await A(),x()}),(e,o)=>{const c=V("el-input"),s=V("el-button");return d(),T("div",G,[p(c,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=m=>u.value=m),type:"textarea",placeholder:"Сообщение",rows:6,resize:"none",class:"voice__textarea"},null,8,["modelValue"]),_("div",J,[r.value&&n.value?(d(),w(s,{key:0,type:"warning",onClick:E,class:"voice__btn voice__btn_permission",icon:f(H),circle:""},null,8,["icon"])):k("",!0),!r.value&&n.value&&i.value?(d(),w(s,{key:1,type:"primary",onClick:C,class:D(["voice__btn",{voice__btn_recording:i.value,voice__btn_disabled:!n.value}]),disabled:!n.value,icon:f(U),circle:""},null,8,["class","disabled","icon"])):k("",!0),!r.value&&n.value?(d(),w(s,{key:2,type:"danger",onClick:C,class:D(["voice__btn",{voice__btn_recording:i.value,voice__btn_disabled:!n.value}]),disabled:!n.value,icon:f(q),circle:""},null,8,["class","disabled","icon"])):k("",!0),p(s,{type:"danger",onClick:z,class:"voice__btn voice__btn_clear",disabled:!u.value,icon:f(j),circle:""},null,8,["disabled","icon"])])])}}}),O=B(K,[["__scopeId","data-v-354e27d5"]]),W={class:"service"},ee={class:"service__container container"},oe={class:"service__block"},te={class:"service__flex"},ae=N({__name:"Service",setup(F){return(y,u)=>(d(),T(Q,null,[p(Y),_("section",W,[_("div",ee,[_("div",oe,[_("div",te,[p(O)])])])]),p(Z)],64))}}),Be=B(ae,[["__scopeId","data-v-93260074"]]);export{Be as default};
